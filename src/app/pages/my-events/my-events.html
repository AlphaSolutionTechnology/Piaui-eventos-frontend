<div class="my-events-root" [class.dark-mode]="isDarkModeActive">
  <!-- Header Reutilizável -->
  <header class="topbar">
    <div class="brand-logo" (click)="navigateToEvents()" style="cursor: pointer">
      <svg class="logo-icon" viewBox="0 0 40 40" fill="none">
        <circle cx="20" cy="20" r="18" fill="url(#bgGradient)" stroke="rgba(255,255,255,0.2)" stroke-width="1" />
        <path d="M12 12h12M12 16h8M12 20h12M12 24h10M12 28h12" stroke="rgba(255,255,255,0.9)" stroke-width="2.5" stroke-linecap="round" />
        <circle cx="30" cy="12" r="2" fill="rgba(255,255,255,0.8)">
          <animate attributeName="opacity" values="0.8;1;0.8" dur="2s" repeatCount="indefinite" />
        </circle>
        <circle cx="32" cy="18" r="1.5" fill="rgba(255,255,255,0.6)">
          <animate attributeName="opacity" values="0.6;0.9;0.6" dur="2.5s" repeatCount="indefinite" />
        </circle>
        <circle cx="30" cy="24" r="1.8" fill="rgba(255,255,255,0.7)">
          <animate attributeName="opacity" values="0.7;1;0.7" dur="3s" repeatCount="indefinite" />
        </circle>
        <defs>
          <linearGradient id="bgGradient" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" style="stop-color: #667eea; stop-opacity: 0.8" />
            <stop offset="50%" style="stop-color: #764ba2; stop-opacity: 0.9" />
            <stop offset="100%" style="stop-color: #f093fb; stop-opacity: 0.7" />
          </linearGradient>
        </defs>
      </svg>
      <span class="brand-text text-brand">EventHub</span>
    </div>
    <nav class="nav"></nav>

    <!-- Card do Usuário -->
    @if (user) {
    <div class="header-right-section">
      <div class="user-avatar" (click)="toggleUserDropdown()">
        <div class="avatar-container">
          @if (user && user.avatar) {
          <img [src]="user.avatar" [alt]="user.name" class="avatar-image" />
          } @else {
          <div class="avatar-initials">{{ getUserInitials() }}</div>
          }
          <div class="avatar-status"></div>
        </div>
        <div class="user-info">
          <span class="user-name text-user-name">{{ user?.name }}</span>
          <span class="user-role text-micro">{{ user?.role }}</span>
        </div>
        <svg class="dropdown-arrow" [class.rotated]="isUserDropdownOpen" width="16" height="16" viewBox="0 0 24 24" fill="none">
          <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
        </svg>

        <!-- Dropdown Menu -->
        @if (isUserDropdownOpen) {
        <div class="user-dropdown" (click)="$event.stopPropagation()">
          <a routerLink="/my-events" class="dropdown-item" (click)="closeUserDropdown()">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="2" />
              <line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" stroke-width="2" />
              <line x1="8" y1="2" x2="8" y2="6" stroke="currentColor" stroke-width="2" />
              <line x1="3" y1="10" x2="21" y2="10" stroke="currentColor" stroke-width="2" />
            </svg>
            Meus Eventos
          </a>
          <a routerLink="/create-event" class="dropdown-item" (click)="closeUserDropdown()">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
              <path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
            Criar Evento
          </a>
          <hr class="dropdown-divider" />
          <a routerLink="/settings" class="dropdown-item" (click)="closeUserDropdown()">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
              <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2" />
              <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z" stroke="currentColor" stroke-width="2" />
            </svg>
            Configurações
          </a>
          <a href="#" class="dropdown-item logout" (click)="logout(); $event.preventDefault()">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
              <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" stroke="currentColor" stroke-width="2" />
              <polyline points="16,17 21,12 16,7" stroke="currentColor" stroke-width="2" />
              <line x1="21" y1="12" x2="9" y2="12" stroke="currentColor" stroke-width="2" />
            </svg>
            Sair
          </a>
        </div>
        }
      </div>
    </div>
    }
  </header>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Page Title -->
    <div class="page-header">
      <h1 class="page-title">Meus Eventos</h1>
      <p class="page-subtitle">Acompanhe os eventos que você criou</p>
    </div>

    <!-- Loading State -->
    @if (isLoading) {
    <div class="loading-container">
      <div class="loading-spinner"></div>
      <p>Carregando seus eventos...</p>
    </div>
    }

    <!-- Error State -->
    @if (error && !isLoading) {
    <div class="error-container">
      <svg width="48" height="48" viewBox="0 0 24 24" fill="none">
        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
        <line x1="15" y1="9" x2="9" y2="15" stroke="currentColor" stroke-width="2" />
        <line x1="9" y1="9" x2="15" y2="15" stroke="currentColor" stroke-width="2" />
      </svg>
      <p>{{ error }}</p>
      <button (click)="loadMyEvents()" class="retry-btn">Tentar Novamente</button>
    </div>
    }

    <!-- Empty State -->
    @if (!isLoading && !error && myEvents.length === 0) {
    <div class="empty-state">
      <svg width="64" height="64" viewBox="0 0 24 24" fill="none">
        <rect x="3" y="4" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="2" />
        <line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" stroke-width="2" />
        <line x1="8" y1="2" x2="8" y2="6" stroke="currentColor" stroke-width="2" />
        <line x1="3" y1="10" x2="21" y2="10" stroke="currentColor" stroke-width="2" />
      </svg>
      <h2>Nenhum evento criado ainda</h2>
      <p>Comece criando seu primeiro evento para que ele apareça aqui</p>
      <a routerLink="/create-event" class="create-btn">Criar Primeiro Evento</a>
    </div>
    }

    <!-- Events Grid -->
    @if (!isLoading && !error && myEvents.length > 0) {
    <div class="events-grid">
      @for (event of myEvents; track event.id) {
      <div class="event-card">
        <div class="event-image">
          <img [src]="event.imageUrl" [alt]="event.name" />
          <div class="event-badge">{{ event.eventType }}</div>
        </div>
        <div class="event-content">
          <h3 class="event-title">{{ event.name }}</h3>
          <p class="event-description">{{ event.description }}</p>
          <div class="event-meta">
            <span class="meta-item">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
                <polyline points="12,6 12,12 16,14" stroke="currentColor" stroke-width="2" />
              </svg>
              {{ event.eventDate }}
            </span>
            <span class="meta-item">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z" stroke="currentColor" stroke-width="2" />
                <circle cx="12" cy="10" r="3" stroke="currentColor" stroke-width="2" />
              </svg>
              {{ event.location }}
            </span>
          </div>
          <div class="event-actions">
            <button (click)="viewEventDetails(event.id)" class="btn btn-primary">Visualizar</button>
            <button (click)="editEvent(event.id)" class="btn btn-secondary">Editar</button>
            <button (click)="deleteEvent(event.id)" class="btn btn-danger">Deletar</button>
          </div>
        </div>
      </div>
      }
    </div>
    }
  </main>
</div>
