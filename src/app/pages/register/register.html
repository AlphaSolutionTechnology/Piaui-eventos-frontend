<div class="register-container">
  <!-- Header -->
  <header class="header">
    <div class="header-content">
      <h1 class="logo text-brand" (click)="navigateToEvents()" style="cursor: pointer">EventHub</h1>
    </div>
  </header>

  <!-- Progress Steps -->
  <div class="steps-container">
    <div class="steps-content">
      <div class="steps-header">
        <button class="back-btn" (click)="goBack()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <path
              d="M19 12H5M12 19L5 12L12 5"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
          {{ currentStep === 1 ? 'Login' : 'Voltar' }}
        </button>
        <h2 class="steps-title">{{ getStepTitle() }}</h2>
      </div>

      <div class="progress-steps">
        <div class="step" [class.active]="currentStep >= 1" [class.completed]="currentStep > 1">
          <div class="step-number text-micro">1</div>
          <div class="step-label text-micro">Pessoal</div>
        </div>
        <div class="step-line" [class.completed]="currentStep > 1"></div>
        <div class="step" [class.active]="currentStep >= 2">
          <div class="step-number text-micro">2</div>
          <div class="step-label text-micro">Conta</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <main class="main-content">
    <div class="register-form">
      <!-- Step 1: Personal Information -->
      <div class="form-step" *ngIf="currentStep === 1">
        <div class="form-card">
          <div class="form-header">
            <div class="welcome-badge">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                <path
                  d="M16 21V19A4 4 0 0 0 12 15H5A4 4 0 0 0 1 19V21"
                  stroke="currentColor"
                  stroke-width="2"
                />
                <circle cx="8.5" cy="7" r="4" stroke="currentColor" stroke-width="2" />
                <line x1="20" y1="8" x2="20" y2="14" stroke="currentColor" stroke-width="2" />
                <line x1="23" y1="11" x2="17" y2="11" stroke="currentColor" stroke-width="2" />
              </svg>
              <span>Junte-se ao EventHub</span>
            </div>
            <h3>Vamos conhecer você</h3>
            <p>Preencha suas informações pessoais para criar sua conta</p>
          </div>

          <div class="form-content">
            <div class="form-row">
              <div class="form-group">
                <label for="firstName">Nome *</label>
                <input
                  type="text"
                  id="firstName"
                  name="firstName"
                  [(ngModel)]="registerForm.firstName"
                  required
                  placeholder="Seu nome"
                  autocomplete="given-name"
                />
              </div>

              <div class="form-group">
                <label for="lastName">Sobrenome *</label>
                <input
                  type="text"
                  id="lastName"
                  name="lastName"
                  [(ngModel)]="registerForm.lastName"
                  required
                  placeholder="Seu sobrenome"
                  autocomplete="family-name"
                />
              </div>
            </div>

            <div class="form-group">
              <label for="email">E-mail *</label>
              <div class="input-wrapper">
                <svg class="input-icon" width="20" height="20" viewBox="0 0 24 24" fill="none">
                  <path
                    d="M4 4H20C21.1 4 22 4.9 22 6V18C22 19.1 21.1 20 20 20H4C2.9 20 2 19.1 2 18V6C2 4.9 2.9 4 4 4Z"
                    stroke="currentColor"
                    stroke-width="2"
                  />
                  <polyline points="22,6 12,13 2,6" stroke="currentColor" stroke-width="2" />
                </svg>
                <input
                  type="email"
                  id="email"
                  name="email"
                  [(ngModel)]="registerForm.email"
                  required
                  placeholder="seu@email.com"
                  autocomplete="email"
                />
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="phone">Telefone *</label>
                <div class="input-wrapper">
                  <svg class="input-icon" width="20" height="20" viewBox="0 0 24 24" fill="none">
                    <path
                      d="M22 16.92V19A2 2 0 0 1 20.11 21A19.79 19.79 0 0 1 2 3.89A2 2 0 0 1 4.08 2H6.16A2 2 0 0 1 8.05 3.53L9.35 7.1A2 2 0 0 1 8.9 9.18L7.74 10.34A16 16 0 0 0 13.66 16.26L14.82 15.1A2 2 0 0 1 16.9 14.65L20.47 15.95A2 2 0 0 1 22 16.92Z"
                      stroke="currentColor"
                      stroke-width="2"
                    />
                  </svg>
                  <input
                    type="tel"
                    id="phone"
                    name="phone"
                    [(ngModel)]="registerForm.phone"
                    required
                    placeholder="(86) 99999-9999"
                    autocomplete="tel"
                  />
                </div>
              </div>

              <div class="form-group">
                <label for="birthDate">Data de Nascimento</label>
                <div class="input-wrapper">
                  <svg class="input-icon" width="20" height="20" viewBox="0 0 24 24" fill="none">
                    <rect
                      x="3"
                      y="4"
                      width="18"
                      height="18"
                      rx="2"
                      ry="2"
                      stroke="currentColor"
                      stroke-width="2"
                    />
                    <line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" stroke-width="2" />
                    <line x1="8" y1="2" x2="8" y2="6" stroke="currentColor" stroke-width="2" />
                    <line x1="3" y1="10" x2="21" y2="10" stroke="currentColor" stroke-width="2" />
                  </svg>
                  <input
                    type="date"
                    id="birthDate"
                    name="birthDate"
                    [(ngModel)]="registerForm.birthDate"
                    autocomplete="bday"
                  />
                </div>
                <small *ngIf="registerForm.birthDate && calculateAge() > 0">
                  Você tem {{ calculateAge() }} anos
                </small>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Step 2: Account Information -->
      <div class="form-step" *ngIf="currentStep === 2">
        <div class="form-card">
          <div class="form-header">
            <div class="welcome-badge">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                <rect
                  x="3"
                  y="11"
                  width="18"
                  height="11"
                  rx="2"
                  ry="2"
                  stroke="currentColor"
                  stroke-width="2"
                />
                <path d="M7 11V7A5 5 0 0 1 17 7V11" stroke="currentColor" stroke-width="2" />
              </svg>
              <span>Proteção da conta</span>
            </div>
            <h3>Crie sua senha</h3>
            <p>Escolha uma senha forte para proteger sua conta</p>
          </div>

          <div class="form-content">
            <div class="form-group">
              <label for="password">Senha *</label>
              <div class="input-wrapper">
                <svg class="input-icon" width="20" height="20" viewBox="0 0 24 24" fill="none">
                  <rect
                    x="3"
                    y="11"
                    width="18"
                    height="11"
                    rx="2"
                    ry="2"
                    stroke="currentColor"
                    stroke-width="2"
                  />
                  <path d="M7 11V7A5 5 0 0 1 17 7V11" stroke="currentColor" stroke-width="2" />
                </svg>
                <input
                  [type]="showPassword ? 'text' : 'password'"
                  id="password"
                  name="password"
                  [(ngModel)]="registerForm.password"
                  required
                  placeholder="Crie uma senha forte"
                  autocomplete="new-password"
                />
                <button type="button" class="password-toggle" (click)="togglePasswordVisibility()">
                  <svg *ngIf="!showPassword" width="20" height="20" viewBox="0 0 24 24" fill="none">
                    <path
                      d="M1 12S5 4 12 4S23 12 23 12S19 20 12 20S1 12 1 12Z"
                      stroke="currentColor"
                      stroke-width="2"
                    />
                    <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2" />
                  </svg>
                  <svg *ngIf="showPassword" width="20" height="20" viewBox="0 0 24 24" fill="none">
                    <path
                      d="M17.94 17.94A10.07 10.07 0 0 1 12 20C5 20 1 12 1 12A16.69 16.69 0 0 1 6.06 6.06M9.9 4.24A9.12 9.12 0 0 1 12 4C19 4 23 12 23 12A16.69 16.69 0 0 1 19.94 17.94"
                      stroke="currentColor"
                      stroke-width="2"
                    />
                    <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2" />
                    <path d="M1 1L23 23" stroke="currentColor" stroke-width="2" />
                  </svg>
                </button>
              </div>

              <!-- Password Strength Indicator -->
              <div class="password-strength" *ngIf="registerForm.password">
                <div class="strength-bar">
                  <div class="strength-fill" [class]="getPasswordStrength()"></div>
                </div>
                <span class="strength-label" [class]="getPasswordStrength()">
                  {{ getPasswordStrengthLabel() }}
                </span>
              </div>

              <div class="password-requirements">
                <div class="requirement" [class.met]="registerForm.password.length >= 8">
                  <svg width="12" height="12" viewBox="0 0 24 24" fill="none">
                    <path
                      d="M9 12L11 14L15 10"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                  Pelo menos 8 caracteres
                </div>
                <div class="requirement" [class.met]="hasUpperCase(registerForm.password)">
                  <svg width="12" height="12" viewBox="0 0 24 24" fill="none">
                    <path
                      d="M9 12L11 14L15 10"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                  Uma letra maiúscula
                </div>
                <div class="requirement" [class.met]="hasLowerCase(registerForm.password)">
                  <svg width="12" height="12" viewBox="0 0 24 24" fill="none">
                    <path
                      d="M9 12L11 14L15 10"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                  Uma letra minúscula
                </div>
                <div class="requirement" [class.met]="hasNumber(registerForm.password)">
                  <svg width="12" height="12" viewBox="0 0 24 24" fill="none">
                    <path
                      d="M9 12L11 14L15 10"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                  Um número
                </div>
              </div>
            </div>

            <div class="form-group">
              <label for="confirmPassword">Confirmar Senha *</label>
              <div class="input-wrapper">
                <svg class="input-icon" width="20" height="20" viewBox="0 0 24 24" fill="none">
                  <rect
                    x="3"
                    y="11"
                    width="18"
                    height="11"
                    rx="2"
                    ry="2"
                    stroke="currentColor"
                    stroke-width="2"
                  />
                  <path d="M7 11V7A5 5 0 0 1 17 7V11" stroke="currentColor" stroke-width="2" />
                </svg>
                <input
                  [type]="showConfirmPassword ? 'text' : 'password'"
                  id="confirmPassword"
                  name="confirmPassword"
                  [(ngModel)]="registerForm.confirmPassword"
                  required
                  placeholder="Digite a senha novamente"
                  autocomplete="new-password"
                />
                <button
                  type="button"
                  class="password-toggle"
                  (click)="toggleConfirmPasswordVisibility()"
                >
                  <svg
                    *ngIf="!showConfirmPassword"
                    width="20"
                    height="20"
                    viewBox="0 0 24 24"
                    fill="none"
                  >
                    <path
                      d="M1 12S5 4 12 4S23 12 23 12S19 20 12 20S1 12 1 12Z"
                      stroke="currentColor"
                      stroke-width="2"
                    />
                    <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2" />
                  </svg>
                  <svg
                    *ngIf="showConfirmPassword"
                    width="20"
                    height="20"
                    viewBox="0 0 24 24"
                    fill="none"
                  >
                    <path
                      d="M17.94 17.94A10.07 10.07 0 0 1 12 20C5 20 1 12 1 12A16.69 16.69 0 0 1 6.06 6.06M9.9 4.24A9.12 9.12 0 0 1 12 4C19 4 23 12 23 12A16.69 16.69 0 0 1 19.94 17.94"
                      stroke="currentColor"
                      stroke-width="2"
                    />
                    <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2" />
                    <path d="M1 1L23 23" stroke="currentColor" stroke-width="2" />
                  </svg>
                </button>
              </div>

              <div class="password-match" *ngIf="registerForm.confirmPassword">
                <div
                  class="match-indicator"
                  [class.match]="registerForm.password === registerForm.confirmPassword"
                >
                  <svg
                    *ngIf="registerForm.password === registerForm.confirmPassword"
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                  >
                    <path
                      d="M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                  <svg
                    *ngIf="registerForm.password !== registerForm.confirmPassword"
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                  >
                    <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
                    <line x1="15" y1="9" x2="9" y2="15" stroke="currentColor" stroke-width="2" />
                    <line x1="9" y1="9" x2="15" y2="15" stroke="currentColor" stroke-width="2" />
                  </svg>
                  <span>
                    {{
                      registerForm.password === registerForm.confirmPassword
                        ? 'Senhas coincidem'
                        : 'Senhas não coincidem'
                    }}
                  </span>
                </div>
              </div>
            </div>

            <!-- Terms and Preferences -->
            <div class="terms-section">
              <div class="checkbox-group">
                <label class="checkbox-label">
                  <input
                    type="checkbox"
                    name="agreeTerms"
                    [(ngModel)]="registerForm.agreeTerms"
                    required
                  />
                  <span class="checkmark"></span>
                  <span class="checkbox-text">
                    Aceito os <a href="#" class="terms-link">termos e condições</a> e a
                    <a href="#" class="terms-link">política de privacidade</a> *
                  </span>
                </label>

                <label class="checkbox-label">
                  <input
                    type="checkbox"
                    name="receiveUpdates"
                    [(ngModel)]="registerForm.receiveUpdates"
                  />
                  <span class="checkmark"></span>
                  <span class="checkbox-text">
                    Desejo receber atualizações sobre eventos e novidades
                  </span>
                </label>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Form Navigation -->
      <div class="form-navigation">
        <button
          type="button"
          class="nav-btn secondary"
          *ngIf="currentStep > 1"
          (click)="prevStep()"
        >
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
            <path
              d="M19 12H5M12 19L5 12L12 5"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
          Anterior
        </button>

        <button
          type="button"
          class="nav-btn primary"
          *ngIf="currentStep < totalSteps"
          (click)="nextStep()"
        >
          Continuar
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
            <path
              d="M5 12H19M12 5L19 12L12 19"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
        </button>

        <button
          type="button"
          class="nav-btn success"
          *ngIf="currentStep === totalSteps"
          (click)="onSubmit()"
          [disabled]="isLoading"
          [class.loading]="isLoading"
        >
          <span *ngIf="!isLoading">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
              <path
                d="M16 21V19A4 4 0 0 0 12 15H5A4 4 0 0 0 1 19V21"
                stroke="currentColor"
                stroke-width="2"
              />
              <circle cx="8.5" cy="7" r="4" stroke="currentColor" stroke-width="2" />
              <line x1="20" y1="8" x2="20" y2="14" stroke="currentColor" stroke-width="2" />
              <line x1="23" y1="11" x2="17" y2="11" stroke="currentColor" stroke-width="2" />
            </svg>
            Criar Conta
          </span>
          <span *ngIf="isLoading" class="loading-text">
            <div class="spinner"></div>
            Criando conta...
          </span>
        </button>
      </div>

      <!-- Login Link -->
      <div class="login-link-section">
        <p>
          Já tem uma conta?
          <button type="button" class="login-link" (click)="navigateToLogin()">Entrar</button>
        </p>
      </div>
    </div>
  </main>

  <!-- Success Modal -->
  <div class="modal-overlay" *ngIf="showSuccess" (click)="showSuccess = false">
    <div class="success-modal" (click)="$event.stopPropagation()">
      <div class="success-icon">
        <svg width="64" height="64" viewBox="0 0 24 24" fill="none">
          <path
            d="M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>
      </div>
      <h3>Conta criada com sucesso!</h3>
      <p>Bem-vindo ao EventHub! Sua conta foi criada e você já pode fazer login.</p>
      <p class="redirect-text">Redirecionando para o login...</p>
    </div>
  </div>

  <!-- Error Alert -->
  <div class="error-alert" *ngIf="showError" [class.show]="showError">
    <div class="error-content">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
        <line x1="15" y1="9" x2="9" y2="15" stroke="currentColor" stroke-width="2" />
        <line x1="9" y1="9" x2="15" y2="15" stroke="currentColor" stroke-width="2" />
      </svg>
      <span>{{ errorMessage }}</span>
    </div>
    <button class="close-error" (click)="showError = false">×</button>
  </div>
</div>
