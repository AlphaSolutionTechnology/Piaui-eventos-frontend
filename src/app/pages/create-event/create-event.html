<div class="create-event-container">
  <!-- Header -->
  <header class="header">
    <div class="header-content">
      <a href="/events" class="logo">
        <h1 class="logo text-brand">EventHub</h1>
      </a>
    </div>
  </header>

  <!-- Progress Steps -->
  <div class="steps-container">
    <div class="steps-content">
      <div class="steps-header">
        <button class="back-btn" (click)="goBack()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <path
              d="M19 12H5M12 19L5 12L12 5"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
          Voltar
        </button>
        <h2 class="steps-title">{{ getStepTitle() }}</h2>
        <div class="back-btn-spacer"></div>
      </div>

      <div class="progress-steps">
        <div class="step" [class.active]="currentStep >= 1" [class.completed]="currentStep > 1">
          <div class="step-number text-micro">1</div>
          <div class="step-label text-micro">Básico</div>
        </div>
        <div class="step-line" [class.completed]="currentStep > 1"></div>
        <div class="step" [class.active]="currentStep >= 2" [class.completed]="currentStep > 2">
          <div class="step-number text-micro">2</div>
          <div class="step-label text-micro">Detalhes</div>
        </div>
        <div class="step-line" [class.completed]="currentStep > 2"></div>
        <div class="step" [class.active]="currentStep >= 3">
          <div class="step-number text-micro">3</div>
          <div class="step-label text-micro">Organizador</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <main class="main-content">
    <div class="create-event-form">
      <!-- Step 1: Basic Information -->
      <div class="form-step" *ngIf="currentStep === 1">
        <div class="form-card">
          <div class="form-header">
            <h3>Informações Básicas do Evento</h3>
            <p>Vamos começar com as informações principais do seu evento</p>
          </div>

          <div class="form-content">
            <div class="form-group">
              <label for="title">Título do Evento *</label>
              <input
                type="text"
                id="title"
                name="title"
                [(ngModel)]="createEventForm.title"
                required
                placeholder="Ex: Workshop de Programação Web"
                maxlength="100"
              />
              <div class="char-count">{{ createEventForm.title.length }}/100</div>
            </div>

            <div class="form-group">
              <label for="description">Descrição do Evento *</label>
              <textarea
                id="description"
                name="description"
                [(ngModel)]="createEventForm.description"
                required
                placeholder="Descreva seu evento de forma clara e atrativa..."
                rows="4"
                maxlength="500"
              ></textarea>
              <div class="char-count">{{ createEventForm.description.length }}/500</div>
            </div>

            <div class="form-group">
              <label for="category">Categoria *</label>
              <div class="category-grid">
                <div
                  class="category-option"
                  *ngFor="let category of categories"
                  [class.selected]="createEventForm.category === category.id"
                  (click)="createEventForm.category = category.id"
                >
                  <span class="category-icon">{{ category.icon }}</span>
                  <span class="category-name">{{ category.name }}</span>
                </div>
              </div>
            </div>

            <div class="form-group">
              <label for="image">Imagem do Evento</label>
              <div class="image-upload">
                <input
                  type="file"
                  id="image"
                  name="image"
                  accept="image/*"
                  (change)="onImageSelected($event)"
                  style="display: none"
                />

                <div class="image-preview" *ngIf="selectedImagePreview">
                  <img [src]="selectedImagePreview" alt="Preview" />
                  <button
                    type="button"
                    class="remove-image"
                    (click)="selectedImagePreview = null; createEventForm.image = null"
                  >
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                      <line x1="18" y1="6" x2="6" y2="18" stroke="currentColor" stroke-width="2" />
                      <line x1="6" y1="6" x2="18" y2="18" stroke="currentColor" stroke-width="2" />
                    </svg>
                  </button>
                </div>

                <label for="image" class="upload-btn" *ngIf="!selectedImagePreview">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <rect
                      x="3"
                      y="3"
                      width="18"
                      height="18"
                      rx="2"
                      ry="2"
                      stroke="currentColor"
                      stroke-width="2"
                    />
                    <circle cx="8.5" cy="8.5" r="1.5" stroke="currentColor" stroke-width="2" />
                    <polyline points="21,15 16,10 5,21" stroke="currentColor" stroke-width="2" />
                  </svg>
                  <span>Clique para adicionar imagem</span>
                  <small>PNG, JPG até 5MB</small>
                </label>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Step 2: Event Details -->
      <div class="form-step" *ngIf="currentStep === 2">
        <div class="form-card">
          <div class="form-header">
            <h3>Detalhes do Evento</h3>
            <p>Defina quando e onde seu evento acontecerá</p>
          </div>

          <div class="form-content">
            <div class="form-row">
              <div class="form-group">
                <label for="date">Data do Evento *</label>
                <input
                  type="date"
                  id="date"
                  name="date"
                  [(ngModel)]="createEventForm.date"
                  required
                />
              </div>

              <div class="form-group">
                <label for="time">Horário *</label>
                <input
                  type="time"
                  id="time"
                  name="time"
                  [(ngModel)]="createEventForm.time"
                  required
                />
              </div>
            </div>

            <div class="form-group">
              <label for="location">Nome do Local *</label>
              <input
                type="text"
                id="location"
                name="location"
                [(ngModel)]="createEventForm.location"
                required
                placeholder="Ex: Centro de Convenções de Teresina"
              />
            </div>

            <div class="form-group">
              <label for="address">Endereço Completo *</label>
              <input
                type="text"
                id="address"
                name="address"
                [(ngModel)]="createEventForm.address"
                required
                placeholder="Rua, número, bairro, cidade - PI"
              />
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="price">Preço (R$)</label>
                <input
                  type="number"
                  id="price"
                  name="price"
                  [(ngModel)]="createEventForm.price"
                  min="0"
                  step="0.01"
                  placeholder="0.00"
                />
                <small>Deixe em R$ 0,00 para evento gratuito</small>
              </div>

              <div class="form-group">
                <label for="maxParticipants">Máximo de Participantes *</label>
                <input
                  type="number"
                  id="maxParticipants"
                  name="maxParticipants"
                  [(ngModel)]="createEventForm.maxParticipants"
                  min="1"
                  required
                />
              </div>
            </div>

            <div class="form-group">
              <label for="tags">Tags do Evento</label>
              <div class="tags-input">
                <div class="tags-container">
                  <span class="tag" *ngFor="let tag of createEventForm.tags">
                    {{ tag }}
                    <button type="button" (click)="removeTag(tag)">×</button>
                  </span>
                  <input
                    type="text"
                    [(ngModel)]="tagInput"
                    name="tagInput"
                    placeholder="Adicionar tag..."
                    (keypress)="onTagInputKeyPress($event)"
                    (blur)="addTag()"
                  />
                </div>
              </div>
              <small>Pressione Enter ou clique fora para adicionar</small>
            </div>

            <div class="settings-group">
              <h4>Configurações do Evento</h4>

              <label class="checkbox-label">
                <input type="checkbox" name="isPublic" [(ngModel)]="createEventForm.isPublic" />
                <span class="checkmark"></span>
                Evento público (aparecerá na listagem)
              </label>

              <label class="checkbox-label">
                <input
                  type="checkbox"
                  name="requiresApproval"
                  [(ngModel)]="createEventForm.requiresApproval"
                />
                <span class="checkmark"></span>
                Requer aprovação para inscrições
              </label>

              <label class="checkbox-label">
                <input
                  type="checkbox"
                  name="allowWaitlist"
                  [(ngModel)]="createEventForm.allowWaitlist"
                />
                <span class="checkmark"></span>
                Permitir lista de espera quando lotado
              </label>
            </div>
          </div>
        </div>
      </div>

      <!-- Step 3: Organizer Information -->
      <div class="form-step" *ngIf="currentStep === 3">
        <div class="form-card">
          <div class="form-header">
            <h3>Informações do Organizador</h3>
            <p>Dados de contato para os participantes</p>
          </div>

          <div class="form-content">
            <div class="form-group">
              <label for="organizerName">Nome do Organizador *</label>
              <input
                type="text"
                id="organizerName"
                name="organizerName"
                [(ngModel)]="createEventForm.organizerName"
                required
                placeholder="Seu nome ou nome da empresa"
              />
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="organizerEmail">E-mail de Contato *</label>
                <input
                  type="email"
                  id="organizerEmail"
                  name="organizerEmail"
                  [(ngModel)]="createEventForm.organizerEmail"
                  required
                  placeholder="contato@exemplo.com"
                />
              </div>

              <div class="form-group">
                <label for="organizerPhone">Telefone *</label>
                <input
                  type="tel"
                  id="organizerPhone"
                  name="organizerPhone"
                  [(ngModel)]="createEventForm.organizerPhone"
                  required
                  placeholder="(86) 99999-9999"
                />
              </div>
            </div>

            <!-- Event Summary -->
            <div class="event-summary">
              <h4>Resumo do Evento</h4>
              <div class="summary-card">
                <div class="summary-header">
                  <h5>{{ createEventForm.title || 'Título do evento' }}</h5>
                  <span class="category-badge" *ngIf="createEventForm.category">
                    {{ getCategoryIcon(createEventForm.category) }}
                    {{ getCategoryName(createEventForm.category) }}
                  </span>
                </div>

                <div class="summary-details">
                  <div class="detail-item" *ngIf="createEventForm.date && createEventForm.time">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                      <rect
                        x="3"
                        y="4"
                        width="18"
                        height="18"
                        rx="2"
                        ry="2"
                        stroke="currentColor"
                        stroke-width="2"
                      />
                      <line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" stroke-width="2" />
                      <line x1="8" y1="2" x2="8" y2="6" stroke="currentColor" stroke-width="2" />
                      <line x1="3" y1="10" x2="21" y2="10" stroke="currentColor" stroke-width="2" />
                    </svg>
                    <span>{{ createEventForm.date }} às {{ createEventForm.time }}</span>
                  </div>

                  <div class="detail-item" *ngIf="createEventForm.location">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                      <path
                        d="M21 10C21 17 12 23 12 23S3 17 3 10A9 9 0 0 1 12 1A9 9 0 0 1 21 10Z"
                        stroke="currentColor"
                        stroke-width="2"
                      />
                      <circle cx="12" cy="10" r="3" stroke="currentColor" stroke-width="2" />
                    </svg>
                    <span>{{ createEventForm.location }}</span>
                  </div>

                  <div class="detail-item">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                      <path
                        d="M17 21V19A4 4 0 0 0 13 15H5A4 4 0 0 0 1 19V21"
                        stroke="currentColor"
                        stroke-width="2"
                      />
                      <circle cx="9" cy="7" r="4" stroke="currentColor" stroke-width="2" />
                      <path
                        d="M23 21V19A4 4 0 0 0 16.5 15.91"
                        stroke="currentColor"
                        stroke-width="2"
                      />
                      <path
                        d="M16 3.13A4 4 0 0 1 16 11.87"
                        stroke="currentColor"
                        stroke-width="2"
                      />
                    </svg>
                    <span>{{ createEventForm.maxParticipants }} participantes</span>
                  </div>

                  <div class="detail-item price" *ngIf="createEventForm.price > 0">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                      <line x1="12" y1="1" x2="12" y2="23" stroke="currentColor" stroke-width="2" />
                      <path
                        d="M17 5H9.5A3.5 3.5 0 0 0 9.5 12H14.5A3.5 3.5 0 0 1 14.5 19H6"
                        stroke="currentColor"
                        stroke-width="2"
                      />
                    </svg>
                    <span>{{ formatCurrency(createEventForm.price) }}</span>
                  </div>

                  <div class="detail-item free" *ngIf="createEventForm.price === 0">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                      <path
                        d="M12 2L15.09 8.26L22 9L17 14L18.18 21L12 17.77L5.82 21L7 14L2 9L8.91 8.26L12 2Z"
                        stroke="currentColor"
                        stroke-width="2"
                      />
                    </svg>
                    <span>Gratuito</span>
                  </div>
                </div>

                <div class="summary-tags" *ngIf="createEventForm.tags.length > 0">
                  <span class="summary-tag" *ngFor="let tag of createEventForm.tags">{{
                    tag
                  }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Form Navigation -->
      <div class="form-navigation">
        <button
          type="button"
          class="nav-btn secondary"
          *ngIf="currentStep > 1"
          (click)="prevStep()"
        >
          Anterior
        </button>

        <button
          type="button"
          class="nav-btn primary"
          *ngIf="currentStep < totalSteps"
          (click)="nextStep()"
        >
          Próximo
        </button>

        <button
          type="button"
          class="nav-btn success"
          *ngIf="currentStep === totalSteps"
          (click)="onSubmit()"
          [disabled]="isLoading"
          [class.loading]="isLoading"
        >
          <span *ngIf="!isLoading">Criar Evento</span>
          <span *ngIf="isLoading" class="loading-text">
            <div class="spinner"></div>
            Criando...
          </span>
        </button>
      </div>
    </div>
  </main>

  <!-- Success Modal -->
  <div class="modal-overlay" *ngIf="showSuccess" (click)="showSuccess = false">
    <div class="success-modal" (click)="$event.stopPropagation()">
      <div class="success-icon">
        <svg width="48" height="48" viewBox="0 0 24 24" fill="none">
          <path
            d="M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>
      </div>
      <h3>Evento Criado!</h3>
      <p>Seu evento foi criado com sucesso e já está disponível na plataforma.</p>
      <p class="redirect-text">Redirecionando para a lista de eventos...</p>
    </div>
  </div>

  <!-- Error Alert -->
  <div class="error-alert" *ngIf="showError" [class.show]="showError">
    <div class="error-content">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
        <line x1="15" y1="9" x2="9" y2="15" stroke="currentColor" stroke-width="2" />
        <line x1="9" y1="9" x2="15" y2="15" stroke="currentColor" stroke-width="2" />
      </svg>
      <span>{{ errorMessage }}</span>
    </div>
    <button class="close-error" (click)="showError = false">×</button>
  </div>
</div>
